<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Virtualization SDK | virtualization-sdk</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Virtualization SDK" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="http://localhost:4000/References/Platform_Libraries.html" />
<meta property="og:url" content="http://localhost:4000/References/Platform_Libraries.html" />
<meta property="og:site_name" content="virtualization-sdk" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://localhost:4000/References/Platform_Libraries.html","headline":"Virtualization SDK","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=52f3c2ef1003e9fe35bc8813a5d4baa843da74c1">
  </head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="http://localhost:4000/">virtualization-sdk</a></h1>
      

      <h1 id="platform-libraries">Platform Libraries</h1>
<p>Set of functions that plugins can use these for executing remote commands, etc.</p>

<h2 id="run_bash">run_bash</h2>

<p>Executes a bash command on a remote Unix host.</p>

<h3 id="signature">Signature</h3>

<p><code class="highlighter-rouge">def run_bash(remote_connection, command, variables=None, use_login_shell=False, check=False)</code></p>

<h3 id="arguments">Arguments</h3>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>remote_connection</td>
      <td><a href="/References/Classes.html#remoteconnection">RemoteConnection</a></td>
      <td>Connection associated with the remote host to run the command on.</td>
    </tr>
    <tr>
      <td>command</td>
      <td>String</td>
      <td>Command to run on the host.</td>
    </tr>
    <tr>
      <td>variables</td>
      <td>dict[String, String]</td>
      <td><strong>Optional</strong>. Environement variables to set when running the command.</td>
    </tr>
    <tr>
      <td>use_login_shell</td>
      <td>boolean</td>
      <td><strong>Optional</strong>. Whether to use a login shell.</td>
    </tr>
    <tr>
      <td>check</td>
      <td>boolean</td>
      <td><strong>Optional</strong>. Whether or not to raise an exception if the <code class="highlighter-rouge">exit_code</code> in the <code class="highlighter-rouge">RunBashResponse</code> is non-zero.</td>
    </tr>
  </tbody>
</table>

<h3 id="returns">Returns</h3>
<p>An object of <code class="highlighter-rouge">RunBashResponse</code></p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>exit_code</td>
      <td>Integer</td>
      <td>Exit code from the command.</td>
    </tr>
    <tr>
      <td>stdout</td>
      <td>String</td>
      <td>Stdout from the command.</td>
    </tr>
    <tr>
      <td>stderr</td>
      <td>String</td>
      <td>Stderr from the command.</td>
    </tr>
  </tbody>
</table>

<h3 id="examples">Examples</h3>

<p>Calling bash with an inline command.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dlpx.virtualization</span> <span class="kn">import</span> <span class="n">libs</span>

<span class="n">command</span> <span class="o">=</span> <span class="s">"echo 'Hi' &gt;&gt; /tmp/debug.log"</span>
<span class="nb">vars</span> <span class="o">=</span> <span class="p">{</span><span class="s">"var"</span><span class="p">:</span> <span class="s">"val"</span><span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">libs</span><span class="o">.</span><span class="n">run_bash</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="nb">vars</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">exit_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">stdout</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">stderr</span>
</code></pre></div></div>

<p>Using parameters to construct a bash command.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dlpx.virtualization</span> <span class="kn">import</span> <span class="n">libs</span>

<span class="n">name</span> <span class="o">=</span> <span class="n">virtual_source</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">username</span>
<span class="n">port</span> <span class="o">=</span> <span class="n">virtual_source</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">port</span>
<span class="n">command</span> <span class="o">=</span> <span class="s">"mysqldump -u {} -p {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">port</span><span class="p">)</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">libs</span><span class="o">.</span><span class="n">run_bash</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">command</span><span class="p">)</span>
</code></pre></div></div>

<p>Running a bash script that is saved in a directory.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 
 <span class="kn">import</span> <span class="nn">pkgutil</span>
 <span class="kn">from</span> <span class="nn">dlpx.virtualization</span> <span class="kn">import</span> <span class="n">libs</span>

 <span class="n">script_content</span> <span class="o">=</span> <span class="n">pkgutil</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s">'resources'</span><span class="p">,</span> <span class="s">'get_date.sh'</span><span class="p">)</span>

 <span class="c"># Execute script on remote host</span>
 <span class="n">response</span> <span class="o">=</span> <span class="n">libs</span><span class="o">.</span><span class="n">run_bash</span><span class="p">(</span><span class="n">direct_source</span><span class="o">.</span><span class="n">connection</span><span class="p">,</span> <span class="n">script_content</span><span class="p">)</span>
</code></pre></div></div>
<p>For more information please go to <a href="/Best_Practices/Managing_Scripts_For_Remote_Execution.md">Managing Scripts for Remote Execution</a> section.</p>

<h2 id="run_expect">run_expect</h2>

<p>Executes a tcl command or script on a remote Unix host.</p>

<h3 id="signature-1">Signature</h3>

<p><code class="highlighter-rouge">def run_expect(remote_connection, command, variables=None)</code></p>

<h3 id="arguments-1">Arguments</h3>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>remote_connection</td>
      <td><a href="/References/Classes.html#remoteconnection">RemoteConnection</a></td>
      <td>Connection associated with the remote host to run the command on.</td>
    </tr>
    <tr>
      <td>command</td>
      <td>String</td>
      <td>Expect(Tcl) command to run.</td>
    </tr>
    <tr>
      <td>variables</td>
      <td>dict[String, String]</td>
      <td><strong>Optional</strong>. Environement variables to set when running the command.</td>
    </tr>
  </tbody>
</table>

<h3 id="returns-1">Returns</h3>
<p>An object of <code class="highlighter-rouge">RunExpectResponse</code></p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>exit_code</td>
      <td>Integer</td>
      <td>Exit code from the command.</td>
    </tr>
    <tr>
      <td>stdout</td>
      <td>String</td>
      <td>Stdout from the command.</td>
    </tr>
    <tr>
      <td>stderr</td>
      <td>String</td>
      <td>Stderr from the command.</td>
    </tr>
  </tbody>
</table>

<h3 id="example">Example</h3>

<p>Calling expect  with an inline command.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dlpx.virtualization</span> <span class="kn">import</span> <span class="n">libs</span>

<span class="n">command</span> <span class="o">=</span> <span class="s">"puts 'Hi'"</span>
<span class="nb">vars</span> <span class="o">=</span> <span class="p">{</span><span class="s">"var"</span><span class="p">:</span> <span class="s">"val"</span><span class="p">}</span>

<span class="n">repsonse</span> <span class="o">=</span> <span class="n">libs</span><span class="o">.</span><span class="n">run_expect</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="nb">vars</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">exit_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">stdout</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">stderr</span>
</code></pre></div></div>

<h2 id="run_powershell">run_powershell</h2>

<p>Executes a powershell command on a remote Windows host.</p>

<h3 id="signature-2">Signature</h3>

<p><code class="highlighter-rouge">def run_powershell(remote_connection, command, variables=None, check=False)</code></p>

<h3 id="arguments-2">Arguments</h3>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>remote_connection</td>
      <td><a href="/References/Classes.html#remoteconnection">RemoteConnection</a></td>
      <td>Connection associated with the remote host to run the command on.</td>
    </tr>
    <tr>
      <td>command</td>
      <td>String</td>
      <td>Command to run to the remote host.</td>
    </tr>
    <tr>
      <td>variables</td>
      <td>dict[String, String]</td>
      <td><strong>Optional</strong>. Environement variables to set when running the command.</td>
    </tr>
    <tr>
      <td>check</td>
      <td>boolean</td>
      <td><strong>Optional</strong>. Whether or not to raise an exception if the <code class="highlighter-rouge">exit_code</code> in the <code class="highlighter-rouge">RunPowershellResponse</code> is non-zero.</td>
    </tr>
  </tbody>
</table>

<h3 id="returns-2">Returns</h3>
<p>An object of <code class="highlighter-rouge">RunPowershellResponse</code></p>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>exit_code</td>
      <td>Integer</td>
      <td>Exit code from the command.</td>
    </tr>
    <tr>
      <td>stdout</td>
      <td>String</td>
      <td>Stdout from the command.</td>
    </tr>
    <tr>
      <td>stderr</td>
      <td>String</td>
      <td>Stderr from the command.</td>
    </tr>
  </tbody>
</table>

<h3 id="example-1">Example</h3>

<p>Calling powershell with an inline command.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dlpx.virtualization</span> <span class="kn">import</span> <span class="n">libs</span>

<span class="n">command</span> <span class="o">=</span> <span class="s">"Write-Output 'Hi'"</span>
<span class="nb">vars</span> <span class="o">=</span> <span class="p">{</span><span class="s">"var"</span><span class="p">:</span> <span class="s">"val"</span><span class="p">}</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">libs</span><span class="o">.</span><span class="n">run_powershell</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="nb">vars</span><span class="p">)</span>

<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">exit_code</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">stdout</span>
<span class="k">print</span> <span class="n">response</span><span class="o">.</span><span class="n">stderr</span>
</code></pre></div></div>

<h2 id="run_sync">run_sync</h2>

<p>Copies files from the remote source host directly into the dSource, without involving a staging host.</p>

<h3 id="signature-3">Signature</h3>

<p><code class="highlighter-rouge">def run_sync(remote_connection, source_directory, rsync_user=None, exclude_paths=None, sym_links_to_follow=None)</code></p>

<h3 id="arguments-3">Arguments</h3>

<table>
  <thead>
    <tr>
      <th>Argument</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>remote_connection</td>
      <td><a href="/References/Classes.html#remoteconnection">RemoteConnection</a></td>
      <td>Connection associated with the remote host to run the command on.</td>
    </tr>
    <tr>
      <td>source_directory</td>
      <td>String</td>
      <td>Directory of files to be synced.</td>
    </tr>
    <tr>
      <td>rsync_user</td>
      <td>String</td>
      <td><strong>Optional</strong> User who has access to the directory to be synced.</td>
    </tr>
    <tr>
      <td>exclude_paths</td>
      <td>list[String]</td>
      <td><strong>Optional</strong> Paths to be excluded.</td>
    </tr>
    <tr>
      <td>sym_links_to_follow</td>
      <td>list[String]</td>
      <td><strong>Optional</strong> Symbollic links to follow if any.</td>
    </tr>
  </tbody>
</table>

<h3 id="returns-3">Returns</h3>

<p>None</p>

<h3 id="example-2">Example</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dlpx.virtualization</span> <span class="kn">import</span> <span class="n">libs</span>

<span class="n">source_directory</span> <span class="o">=</span> <span class="s">"sourceDirectory"</span>
<span class="n">rsync_user</span> <span class="o">=</span> <span class="s">"rsyncUser"</span>
<span class="n">exclude_paths</span> <span class="o">=</span> <span class="p">[</span><span class="s">"/path1"</span><span class="p">,</span> <span class="s">"/path2"</span><span class="p">]</span>
<span class="n">sym_links_to_follow</span> <span class="o">=</span> <span class="p">[</span><span class="s">"/path3"</span><span class="p">,</span> <span class="s">"/path4"</span><span class="p">]</span>

<span class="n">libs</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">source_directory</span><span class="p">,</span> <span class="n">rsync_user</span><span class="p">,</span> <span class="n">exclude_paths</span><span class="p">,</span> <span class="n">sym_links_to_follow</span><span class="p">)</span>
</code></pre></div></div>


      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
