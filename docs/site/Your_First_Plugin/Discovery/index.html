



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/logo.png">
      <meta name="generator" content="mkdocs-0.17.5, mkdocs-material-2.9.2">
    
    
      
        <title>Virtualization SDK</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.fbb7f3af.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Helvetica+Neue:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Helvetica Neue","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#discovery" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Delphix Virtualization SDK" class="md-header-nav__button md-logo">
          
            <img src="../../images/delphix-logo-white.png" width="153" height="15">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Delphix Virtualization SDK
              </span>
              <span class="md-header-nav__topic">
                Discovery
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/delphix-logo-white.png" width="48" height="48">
      
    </span>
    Delphix Virtualization SDK
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome!" class="md-nav__link">
      Welcome!
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Getting_Started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Your First Plugin
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Your First Plugin
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Discovery
      </label>
    
    <a href="./" title="Discovery" class="md-nav__link md-nav__link--active">
      Discovery
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-discovery" title="What is Discovery?" class="md-nav__link">
    What is Discovery?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-configs-and-repositories" title="Source Configs and Repositories" class="md-nav__link">
    Source Configs and Repositories
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-source-configs-and-repositories" title="What are Source Configs and Repositories?" class="md-nav__link">
    What are Source Configs and Repositories?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-your-data-formats" title="Defining Your Data Formats" class="md-nav__link">
    Defining Your Data Formats
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-discovery-in-your-plugin" title="Implementing Discovery in Your Plugin" class="md-nav__link">
    Implementing Discovery in Your Plugin
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-python-code" title="About Python Code" class="md-nav__link">
    About Python Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository-discovery" title="Repository Discovery" class="md-nav__link">
    Repository Discovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-config-discovery" title="Source Config Discovery" class="md-nav__link">
    Source Config Discovery
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-run-discovery-in-the-delphix-engine" title="How to Run Discovery in the Delphix Engine" class="md-nav__link">
    How to Run Discovery in the Delphix Engine
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Data_Ingestion/" title="Data Ingestion" class="md-nav__link">
      Data Ingestion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Provisioning/" title="Provisioning" class="md-nav__link">
      Provisioning
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      References
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Decorators/" title="Decorators" class="md-nav__link">
      Decorators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Plugin_Operations/" title="Plugin Operations" class="md-nav__link">
      Plugin Operations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Workflows/" title="Workflows" class="md-nav__link">
      Workflows
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Classes/" title="Classes" class="md-nav__link">
      Classes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Schemas/" title="Schemas" class="md-nav__link">
      Schemas
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Schemas_and_Autogenerated_Classes/" title="Schemas and Autogenerated Classes" class="md-nav__link">
      Schemas and Autogenerated Classes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/CLI/" title="CLI" class="md-nav__link">
      CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Plugin_Versioning/" title="Plugin Versioning" class="md-nav__link">
      Plugin Versioning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../References/Logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Best Practices
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Best Practices
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Best_Practices/Sensitive_Data/" title="Dealing With Sensitive Data" class="md-nav__link">
      Dealing With Sensitive Data
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-discovery" title="What is Discovery?" class="md-nav__link">
    What is Discovery?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-configs-and-repositories" title="Source Configs and Repositories" class="md-nav__link">
    Source Configs and Repositories
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-source-configs-and-repositories" title="What are Source Configs and Repositories?" class="md-nav__link">
    What are Source Configs and Repositories?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-your-data-formats" title="Defining Your Data Formats" class="md-nav__link">
    Defining Your Data Formats
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementing-discovery-in-your-plugin" title="Implementing Discovery in Your Plugin" class="md-nav__link">
    Implementing Discovery in Your Plugin
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#about-python-code" title="About Python Code" class="md-nav__link">
    About Python Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository-discovery" title="Repository Discovery" class="md-nav__link">
    Repository Discovery
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-config-discovery" title="Source Config Discovery" class="md-nav__link">
    Source Config Discovery
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-run-discovery-in-the-delphix-engine" title="How to Run Discovery in the Delphix Engine" class="md-nav__link">
    How to Run Discovery in the Delphix Engine
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="discovery">Discovery<a class="headerlink" href="#discovery" title="Permanent link">&para;</a></h1>
<h2 id="what-is-discovery">What is Discovery?<a class="headerlink" href="#what-is-discovery" title="Permanent link">&para;</a></h2>
<p>In order to ingest data from a source environment, the Delphix Engine first needs to learn information about that data: Where does it live? How can it be accessed? What is it called?</p>
<p><a href="../../References/Glossary/#discovery">Discovery</a> is the process by which the Delphix Engine learns about remote data. Discovery can be either <a href="../../References/Glossary/#automatic-discovery">automatic</a> (where the plugin finds the remote data on its own), or <a href="../../References/Glossary/#manual-discovery">manual</a> (where the user tells us about the remote data). For our first plugin, we'll be using a mix of these two techniques.</p>
<h2 id="source-configs-and-repositories">Source Configs and Repositories<a class="headerlink" href="#source-configs-and-repositories" title="Permanent link">&para;</a></h2>
<h3 id="what-are-source-configs-and-repositories">What are Source Configs and Repositories?<a class="headerlink" href="#what-are-source-configs-and-repositories" title="Permanent link">&para;</a></h3>
<p>A <a href="../../References/Glossary/#source-config">source config</a> is a collection of information that Delphix uses to represent a dataset. Different plugins will have different ideas about what a "dataset" is (an entire database? a set of config files? an application?), but for our first plugin, it is simply a directory tree on the filesystem of the remote environment.</p>
<p>A <a href="../../References/Glossary/#repository">repository</a> represents what you might call "data dependencies" -- anything installed on the remote host that the dataset depends on. For example, if you're working with a Postgres database, then your repository will represent an installation of a particular version of the Postgres DBMS. In this plugin, we don't have any special dependencies, except for the simple existence of the unix system on which the directory lives.</p>
<h3 id="defining-your-data-formats">Defining Your Data Formats<a class="headerlink" href="#defining-your-data-formats" title="Permanent link">&para;</a></h3>
<p>Because each plugin will have different ideas about what a repository or source config represents, different plugins will have different sets of information that they will need to collect/store for each of these.</p>
<p>Delphix needs to know the format of this information. How many pieces of information are collected? What are they called? Are they strings? Numbers?</p>
<p>For our first plugin, we don't need a lot of information here, but see (link to advanced example) for a more complicated example. We use no special information about our repositories (except some way for the user to identify them). For source configs, we just need to know the path to the directory from which we will be ingesting data.</p>
<p>The plugin needs to describe all of this to the Delphix Engine, and it does it using <a href="../../References/Glossary/#schema">schemas</a>.  To create the necessary schemas for our first plugin, (TODO: describe here where exactly these schemas go, when that is finalizedâ€¦ e.g. "create a new file called 'repositorySchema.json' and add the following content)</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;repoName&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;repoName&quot;</span><span class="p">],</span>
  <span class="nt">&quot;nameField&quot;</span><span class="p">:</span> <span class="s2">&quot;repoName&quot;</span><span class="p">,</span>
  <span class="nt">&quot;identityFields&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;repoName&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>


<p>(TODO: if possible, autogenerate this snippet from actual checked-in tested code instead of having it manually typed out here, so that we guarantee our doc code snippets never stop working)
(TODO: change this if we decide to keep the "name" and "identity" bits outside of the schema)</p>
<p>For detailed information about exactly how repository schemas works, see (link to reference). In essence, we are here defining only a single string property which will serve to uniquely identify the repository and will serve as a user-visible name.</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
      <span class="nt">&quot;prettyName&quot;</span><span class="p">:</span> <span class="s2">&quot;Dataset Name&quot;</span><span class="p">,</span>
      <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;User-visible name for this dataset&quot;</span>
    <span class="p">}</span>
    <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
      <span class="nt">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;unixpath&quot;</span><span class="p">,</span>
      <span class="nt">&quot;prettyName&quot;</span><span class="p">:</span> <span class="s2">&quot;Path&quot;</span><span class="p">,</span>
      <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Full path to data location on the remote environment&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nt">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;path&quot;</span><span class="p">],</span>
  <span class="nt">&quot;additionalFields&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="nt">&quot;nameField&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
  <span class="nt">&quot;identityFields&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;path&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>


<p>Because we are going to be asking the user to fill in these fields, we've added some extra information in our schemas. Our values for "prettyName" and "description" will be show to the user in the UI. In addition, we've used the "additionalFields" flag to stop the user from (accidentally?) providing extra information that we don't need. Finally, note that we're using the special <code>unixpath</code> format specifier, which will allow the UI to enforce that a valid Unix path is entered by the user.</p>
<p>Please see (link to reference) for full details about what you can do in these schemas.</p>
<h2 id="implementing-discovery-in-your-plugin">Implementing Discovery in Your Plugin<a class="headerlink" href="#implementing-discovery-in-your-plugin" title="Permanent link">&para;</a></h2>
<h3 id="about-python-code">About Python Code<a class="headerlink" href="#about-python-code" title="Permanent link">&para;</a></h3>
<p>As described in the overview section, plugins customize the behavior of the Delphix Engine by providing Python code. Each customizable piece of behavior is called a "plugin operation". The plugin provides separate Python functions for each of the operations that it wants to customize.</p>
<p>Right now, we're concerned with discovery. There are two customizable operations related to automatic discovery, one for repositories and one for source configs. In both cases, the job of the Python method is to automatically collect whatever information the schemas (see above) require, and to return that information to the Delphix Engine. The Delphix Engine will run these customized operations whenever a new environment is added, or when an existing environment is rediscovered.</p>
<h3 id="repository-discovery">Repository Discovery<a class="headerlink" href="#repository-discovery" title="Permanent link">&para;</a></h3>
<p>For repositories, we'll need to write a "repository discovery" operation in Python. The job of this operation is to examine a remote environment, find any repositories, and return information about them to the Delphix Engine.</p>
<p>In our case, we know that each remote environment is going to have exactly one repository, and so our "repository discovery" operation can be very simple.</p>
<p>Create a file in your preferred editor (TODO: add suggested/required filename), and add the following Python code. (TODO: revisit when decorators are finalized)</p>
<div class="codehilite"><pre><span></span><span class="nd">@delphix.repository_discovery</span>
<span class="k">def</span> <span class="nf">do_discovery_for_repositories</span><span class="p">(</span><span class="n">environment</span><span class="p">):</span>
    <span class="n">the_repo</span> <span class="o">=</span> <span class="n">Repository</span><span class="p">()</span>
    <span class="n">the_repo</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Directory Tree&quot;</span>

    <span class="k">return</span> <span class="p">[</span> <span class="n">the_repo</span> <span class="p">]</span>
</pre></div>


<div class="admonition note">
<p class="admonition-title">Gotcha</p>
<p>Be careful to always use consistent indentation in Python code!</p>
</div>
<p>Taking this line-by-line, here's what's happening in our new method:</p>
<div class="codehilite"><pre><span></span><span class="nd">@delphix.repository_discovery</span>
</pre></div>


<p>This is a Python <a href="../../References/Glossary/#decorator">decorator</a> which signals to the Delphix Engine that we want to customize the behavior of repository discovery, and that this function is the one that provides that customization</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">do_discovery_for_repositories</span><span class="p">(</span><span class="n">environment</span><span class="p">):</span>
</pre></div>


<p>This begins a Python function definition. We can call this function whatever we like, but generally you'll want to pick something descriptive. As with most operations, the Delphix Engine will provide input to the repository discovery operation. In this particular case, the Engine provides one input which describes the remote environment which we are describing. For more details about operation inputs, see (link to reference).</p>
<div class="codehilite"><pre><span></span><span class="n">the_repo</span> <span class="o">=</span> <span class="n">Repository</span><span class="p">()</span>
</pre></div>


<p>Here, we are constructing a new Python object which will conform to the repository schema we created in the previous section. This Python type <code>Repository</code> is automatically created for you based on that schema, and so this python object will have properties to correspond to the properties defined in that schema.</p>
<div class="codehilite"><pre><span></span><span class="n">the_repo</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Directory Tree&quot;</span>
</pre></div>


<p>Our repository only has one property: a user-visible name. Here we want to choose some name that will let the user understand what kind of data this repository can work with. We'll just call it "Directory Tree".</p>
<div class="codehilite"><pre><span></span><span class="k">return</span> <span class="p">[</span> <span class="n">the_repo</span> <span class="p">]</span>
</pre></div>


<p>The job of this operation is to return a list of all repositories on the remote environment. In our case, we want exactly one repository per environment. So, here we just make a one-item Python list, and return it to the Delphix Engine.</p>
<h3 id="source-config-discovery">Source Config Discovery<a class="headerlink" href="#source-config-discovery" title="Permanent link">&para;</a></h3>
<p>For source configs, we'll rely solely on manual discovery -- the user will tell us which directories they want to ingest from. Because we are not using automatic source config discovery, we will not need to write a custom operation here. But, see (link to advanced example) for a plugin that does define its own discovery operation for source configs,</p>
<p>To declare that we want to allow manual source config discovery, we just need to specify that in our manifest (link to manifest page). To do this,
(TODO: We have not finalized what the manifest/metadata/main.json will look like. When we do, add in details here about how to modify it to allow manual discovery)</p>
<p>When the user tries to add a new source config, the Delphix Engine will generate a UI based on the contents of your source config schema. Thus, the user will be able to enter all the data that your plugin needs.</p>
<h2 id="how-to-run-discovery-in-the-delphix-engine">How to Run Discovery in the Delphix Engine<a class="headerlink" href="#how-to-run-discovery-in-the-delphix-engine" title="Permanent link">&para;</a></h2>
<p>Let's try it out and make sure discovery works!</p>
<p>First, follow the instructions here (link to SDK doc) to build your plugin and install it onto a Delphix Engine.</p>
<p>Once the plugin is installed, add a remote unix environment to your engine. To do this, go to "Manage/Environments", click "add", answer the questions, and submit. (If you already have an environment set up, you can just refresh it).</p>
<p>To keep an eye on this discovery process, you may need to open the "operations" tab on the UI. If any errors happen, they'll be reported here.</p>
<p>(TODO: animated GIF here showing where to click on the UI?)</p>
<p>After the automatic discovery process completes, go to the "Databases" tab. You should see an entry for "Directory Tree". That's the repository you created in your Python code.</p>
<p>Because you've specified that manual discovery of source configs is allowed, you should be able to click the "Add Dataset" button next to "Directory Tree". This should bring up a UI which will allow you to enter all the pieces of information that your plugin has specified in the schema.</p>
<p>(TODO: animated GIF here showing manual discovery?)</p>
<div class="admonition note">
<p class="admonition-title">Gotcha</p>
<p>Once you've manually created a source config, you will not be allowed to modify your plugin's source config schema. We'll cover how to deal with this correctly later, in the upgrade section. For now, if you need to change your plugin's source config schema, you'll have to first delete any source configs you've manually added.</p>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Overview/" title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Overview
              </span>
            </div>
          </a>
        
        
          <a href="../Data_Ingestion/" title="Data Ingestion" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Data Ingestion
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 Delphix Corp.
          </div>
        
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://www.delphix.com/" class="md-footer-social__link fa fa-sitemap"></a>
    
      <a href="https://www.facebook.com/DelphixCorp/" class="md-footer-social__link fa fa-facebook"></a>
    
      <a href="https://twitter.com/delphix" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/delphix" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://github.com/delphix" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.878fdd8d.js"></script>
      
      <script>app.initialize({version:"0.17.5",url:{base:"../.."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-35429885-3","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>